import{a as T,Q as P,_ as U,c as A,b as u}from"./agos-profile-BZZaKOyD.js";import{Q as r}from"./QItem-BaSvKx04.js";import{Q as V}from"./QSeparator-4i1DWy0G.js";import{Q as b}from"./QInput-BycsZq4a.js";import{Q as C,R as Q}from"./QBtn-BsZISHPL.js";import{Q as N}from"./QFile-COInTEZj.js";import{Q as v}from"./QIcon-Klu63Zva.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as k,K as t,O as l,L as a,r as i,o as O,V as m,T as _,R as c,k as S,U as R,J as f,W as E,Q as L}from"./index-CPH3rA8_.js";import"./use-dark-BWYx2eMP.js";import"./private.use-form-DgFkV_-4.js";const W={setup(){const g=i([{username:"Ágoston",userId:1,email:"agoston@email.com",picture:"../assets/agos-profile.jpeg",token:"password"}]),e=i(!0),I=i(""),o=i(!1),n=i(""),p=i(""),s=i("");O(()=>{e.value=localStorage.getItem("isLoggedIn")==="true",I.value=localStorage.getItem("loggedInId"),s.value=localStorage.getItem("usertoken")});const w=async()=>{if(n.value&&p.value){const B={email:n.value,password:p.value};try{const d=await fetch("https://vibemapbe.com/auth/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(d.ok){e.value=!0,localStorage.setItem("isLoggedIn","true");const x=await d.json();console.log(x),s.value=x.access_token,localStorage.setItem("usertoken",x.access_token),this.$router.push("/"),alert("Login successful! Welcome back "+n.value)}else console.error("Login failed",d.responseText),alert("Login failed",d.responseText)}catch(d){console.error("Error during login",d)}}else console.error("Email and password are required"),alert("Email and password are required")},y=()=>{e.value=!1,localStorage.setItem("isLoggedIn","false"),localStorage.setItem("loggedInId",null),n.value="",p.value="",q()},q=()=>{location.reload()};return{login:w,logout:y,editProfile:()=>{o.value=!0,console.log(o.value)},saveProfile:()=>{o.value=!1,console.log(o.value)},profileEdit:o,email:n,password:p,isLoggedIn:e,loggedInId:I,userInfo:g}}},z={class:"text-primary text-center q-pa-md flex flex-center w-100"},D={class:"q-mt-md text-h6"},F={class:"text-caption text-grey"};function J(g,e,I,o,n,p){return t(),k("div",z,[l(T,{class:"w-100"},{default:a(()=>[o.isLoggedIn?m("",!0):(t(),k(_,{key:0},[l(r,{class:"q-pa-md column items-center w-100"},{default:a(()=>[l(P,{size:"72px"},{default:a(()=>e[3]||(e[3]=[c("img",{src:U,alt:"User Avatar"},null,-1)])),_:1}),e[4]||(e[4]=c("div",{class:"q-mt-md text-h6"},"Welcome",-1)),e[5]||(e[5]=c("div",{class:"text-caption text-grey"},"Please login or sign up",-1))]),_:1}),l(V),l(r,{class:"w-100"},{default:a(()=>[l(b,{modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=s=>o.email=s),label:"Email",type:"email",filled:"",class:"full-width"},null,8,["modelValue"])]),_:1}),l(r,{class:"w-100"},{default:a(()=>[l(b,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=s=>o.password=s),label:"Password",type:"password",filled:"",class:"full-width"},null,8,["modelValue"])]),_:1}),l(r,{class:"q-gutter-sm w-100"},{default:a(()=>[l(C,{label:"Login",color:"primary",class:"col-6",onClick:o.login},null,8,["onClick"]),l(C,{label:"Signup",color:"secondary",outline:"",class:"col-6",to:"./signup"})]),_:1})],64)),o.isLoggedIn?(t(),k(_,{key:1},[(t(!0),k(_,null,R(o.userInfo,(s,w)=>(t(),f(r,{class:"q-pa-md column items-center w-100",key:w},{default:a(()=>[l(P,{size:"160px"},{default:a(()=>[e[6]||(e[6]=c("img",{src:A,alt:"User Avatar"},null,-1)),o.profileEdit?(t(),f(N,{key:0,class:"picture-edit",modelValue:g.profilePicture,"onUpdate:modelValue":e[2]||(e[2]=y=>g.profilePicture=y),filled:"",accept:"image/*","max-files":1,onAdded:g.previewImage},null,8,["modelValue","onAdded"])):m("",!0),o.profileEdit?(t(),f(v,{key:1,class:"picture-edit-icon",name:"edit"})):m("",!0)]),_:1}),c("div",D,E(s.username),1),c("div",F,E(s.email),1)]),_:2},1024))),128)),l(V),o.profileEdit?m("",!0):S((t(),f(r,{key:0,clickable:"",class:"",onClick:o.editProfile},{default:a(()=>[l(u,{avatar:""},{default:a(()=>[l(v,{name:"edit"})]),_:1}),l(u,null,{default:a(()=>e[7]||(e[7]=[L("Edit profile")])),_:1})]),_:1},8,["onClick"])),[[Q]]),o.profileEdit?S((t(),f(r,{key:1,clickable:"",class:"",onClick:o.saveProfile},{default:a(()=>[l(u,{avatar:""},{default:a(()=>[l(v,{name:"save"})]),_:1}),l(u,null,{default:a(()=>e[8]||(e[8]=[L("Save profile")])),_:1})]),_:1},8,["onClick"])),[[Q]]):m("",!0),S((t(),f(r,{clickable:"",class:"text-red",onClick:o.logout},{default:a(()=>[l(u,{avatar:""},{default:a(()=>[l(v,{name:"logout",color:"red"})]),_:1}),l(u,null,{default:a(()=>e[9]||(e[9]=[L("Logout")])),_:1})]),_:1},8,["onClick"])),[[Q]])],64)):m("",!0)]),_:1})])}const te=j(W,[["render",J]]);export{te as default};
