import{a as E,Q as S}from"./QInput-BycsZq4a.js";import{Q as B}from"./QFile-COInTEZj.js";import{Q as R,h as N}from"./QIcon-Klu63Zva.js";import{c as Q,h as g,a as A,r as p,B as j,C as T,o as D,g as L,z as U,d as M,E as O,_ as $,S as k,K as w,R as q,O as m,L as z,$ as H,Q as K}from"./index-CPH3rA8_.js";import{u as J,a as G,b as W}from"./use-checkbox-DQdYRrzU.js";import{a as X,Q as F}from"./QBtn-BsZISHPL.js";import"./use-dark-BWYx2eMP.js";import"./private.use-form-DgFkV_-4.js";const Y=()=>g("div",{key:"svg",class:"q-checkbox__bg absolute"},[g("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[g("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),g("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),Z=Q({name:"QCheckbox",props:G,emits:J,setup(s){const f=Y();function i(v,n){const l=A(()=>(v.value===!0?s.checkedIcon:n.value===!0?s.indeterminateIcon:s.uncheckedIcon)||null);return()=>l.value!==null?[g("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[g(R,{class:"q-checkbox__icon",name:l.value})])]:[f]}return W("checkbox",i)}}),ee=Q({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(s,{slots:f,emit:i}){const v=L(),n=p(null);let l=0;const r=[];function u(t){const e=typeof t=="boolean"?t:s.noErrorFocus!==!0,o=++l,P=(a,d)=>{i(`validation${a===!0?"Success":"Error"}`,d)},C=a=>{const d=a.validate();return typeof d.then=="function"?d.then(c=>({valid:c,comp:a}),c=>({valid:!1,comp:a,err:c})):Promise.resolve({valid:d,comp:a})};return(s.greedy===!0?Promise.all(r.map(C)).then(a=>a.filter(d=>d.valid!==!0)):r.reduce((a,d)=>a.then(()=>C(d).then(c=>{if(c.valid===!1)return Promise.reject(c)})),Promise.resolve()).catch(a=>[a])).then(a=>{if(a===void 0||a.length===0)return o===l&&P(!0),!0;if(o===l){const{comp:d,err:c}=a[0];if(c!==void 0&&console.error(c),P(!1,d),e===!0){const I=a.find(({comp:_})=>typeof _.focus=="function"&&X(_.$)===!1);I!==void 0&&I.comp.focus()}}return!1})}function x(){l++,r.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function h(t){t!==void 0&&U(t);const e=l+1;u().then(o=>{e===l&&o===!0&&(s.onSubmit!==void 0?i("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function y(t){t!==void 0&&U(t),i("reset"),M(()=>{x(),s.autofocus===!0&&s.noResetFocus!==!0&&b()})}function b(){E(()=>{if(n.value===null)return;const t=n.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||n.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||n.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(n.value.querySelectorAll("[tabindex]"),e=>e.tabIndex!==-1);t?.focus({preventScroll:!0})})}O($,{bindComponent(t){r.push(t)},unbindComponent(t){const e=r.indexOf(t);e!==-1&&r.splice(e,1)}});let V=!1;return j(()=>{V=!0}),T(()=>{V===!0&&s.autofocus===!0&&b()}),D(()=>{s.autofocus===!0&&b()}),Object.assign(v.proxy,{validate:u,resetValidation:x,submit:h,reset:y,focus:b,getValidationComponents:()=>r}),()=>g("form",{class:"q-form",ref:n,onSubmit:h,onReset:y},N(f.default))}}),te={class:"text-primary text-center q-pa-md flex flex-center"},oe={key:0,class:"q-mt-md"},ae=["src"],le={key:1,class:"q-mt-md",style:{"max-width":"200px","max-height":"200px",border:"2px dashed #ccc",display:"flex","justify-content":"center","align-items":"center","font-size":"14px",color:"#aaa"}},se={class:"text-h6",style:{opacity:".4"}},pe={__name:"SignupPage",setup(s){const f=p(""),i=p(""),v=p(""),n=p(""),l=p(!1),r=p(null),u=p(null),x=A(()=>i.value!==v.value),h=t=>{if(t){const e=new FileReader;e.onload=o=>{u.value=o.target.result},e.readAsDataURL(u)}else u.value="";return{profilePicture:t,imageUrl:u,handleFileUpload:h}},y=()=>{u.value&&(localStorage.setItem("uploadedImage",u.value),console.log("Image saved to local storage."))},b=()=>{if(!x.value){console.log({email:f.value,password:i.value,passwordConfirm:v.value,username:n.value,termsAccepted:l.value,profilePicture:r.value});var t={email:f.value,password:i.value};fetch("https://vibemapbe.com/auth/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{console.log("Signup successful:",e),this.$router.push("/"),y()}).catch(e=>{console.error("Signup error:",e),alert("Signup failed. Please try again. Error: "+e)})}},V=()=>{const t=r.value?.[0];if(t){const e=new FileReader;e.onload=o=>{u.value=o.target.result},e.readAsDataURL(t)}};return(t,e)=>(w(),k("div",te,[q("div",null,[e[7]||(e[7]=q("div",{class:"text-h5"},"Signup Page",-1)),m(ee,{class:"q-gutter-md signup-form",onSubmit:H(b,["prevent"])},{default:z(()=>[m(S,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),label:"Username",filled:"",required:""},null,8,["modelValue"]),m(B,{modelValue:r.value,"onUpdate:modelValue":[e[1]||(e[1]=o=>r.value=o),h],label:"Upload Profile Picture",filled:"",accept:"image/*","max-files":1,onAdded:V},null,8,["modelValue"]),u.value?(w(),k("div",oe,[q("img",{src:u.value,alt:"Profile Preview",class:"q-mb-md",style:{"max-width":"200px","max-height":"200px","object-fit":"cover"}},null,8,ae)])):(w(),k("div",le," No Image Uploaded ")),m(S,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=o=>f.value=o),label:"Email Address",type:"email",filled:"",required:""},null,8,["modelValue"]),m(S,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=o=>i.value=o),label:"Password",type:"password",filled:"",required:""},null,8,["modelValue"]),m(S,{modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=o=>v.value=o),label:"Confirm Password",type:"password",filled:"",required:"",error:x.value,"error-message":"Passwords do not match"},null,8,["modelValue","error"]),m(Z,{modelValue:l.value,"onUpdate:modelValue":e[5]||(e[5]=o=>l.value=o),label:"I agree to the Terms of Use",required:""},null,8,["modelValue"]),m(F,{label:"Sign Up",color:"primary",type:"submit",unelevated:"",class:"q-mt-md"})]),_:1}),q("div",se,[e[6]||(e[6]=K(" Already have an account? ")),m(F,{flat:"",to:"/profile",label:"Login"})])])]))}};export{pe as default};
