import{u as X,d as Y,c as G,Q as O,e as H}from"./QIcon-BW9xVhcS.js";import{R as J}from"./QBtn-D7qRqYLB.js";import{u as Z,a as ee}from"./use-dark-vPTJJDJg.js";import{c as K,g as w,a as r,h as m,z as E,r as T,x as te,q as le,a2 as ie,v as ne}from"./index-F-9fuQYe.js";import{u as ae,c as ue,d as oe,e as re,f as L,h as ce,g as se}from"./QInput-DvQqTaEJ.js";import{u as de,c as fe}from"./private.use-form-DwVI9r9C.js";const me={xs:8,sm:10,md:14,lg:20,xl:24},ve=K({name:"QChip",props:{...Z,...X,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:d,emit:b}){const{proxy:{$q:g}}=w(),o=ee(e,g),c=Y(e,me),y=r(()=>e.selected===!0||e.icon!==void 0),x=r(()=>e.selected===!0?e.iconSelected||g.iconSet.chip.selected:e.icon),k=r(()=>e.iconRemove||g.iconSet.chip.remove),F=r(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),_=r(()=>{const i=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(i?` text-${i} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(F.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(o.value===!0?" q-chip--dark q-dark":"")}),C=r(()=>{const i=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},q={...i,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||g.lang.label.remove};return{chip:i,remove:q}});function z(i){i.keyCode===13&&V(i)}function V(i){e.disable||(b("update:selected",!e.selected),b("click",i))}function D(i){(i.keyCode===void 0||i.keyCode===13)&&(E(i),e.disable===!1&&(b("update:modelValue",!1),b("remove")))}function u(){const i=[];F.value===!0&&i.push(m("div",{class:"q-focus-helper"})),y.value===!0&&i.push(m(O,{class:"q-chip__icon q-chip__icon--left",name:x.value}));const q=e.label!==void 0?[m("div",{class:"ellipsis"},[e.label])]:void 0;return i.push(m("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},H(d.default,q))),e.iconRight&&i.push(m(O,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&i.push(m(O,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:k.value,...C.value.remove,onClick:D,onKeyup:D})),i}return()=>{if(e.modelValue===!1)return;const i={class:_.value,style:c.value};return F.value===!0&&Object.assign(i,C.value.chip,{onClick:V,onKeyup:z}),G("div",i,u(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[J,e.ripple]])}}});function N(e,d,b,g){const o=[];return e.forEach(c=>{g(c)===!0?o.push(c):d.push({failedPropValidation:b,file:c})}),o}function P(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),E(e)}const ge={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},he=["rejected"];function be({editable:e,dnd:d,getFileInput:b,addFilesToQueue:g}){const{props:o,emit:c,proxy:y}=w(),x=T(null),k=r(()=>o.accept!==void 0?o.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),F=r(()=>parseInt(o.maxFiles,10)),_=r(()=>parseInt(o.maxTotalSize,10));function C(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&te(t);else{const h=b();h&&h!==t.target&&h.click(t)}}function z(t){e.value&&t&&g(null,t)}function V(t,h,j,I){let n=Array.from(h||t.target.files);const v=[],p=()=>{v.length!==0&&c("rejected",v)};if(o.accept!==void 0&&k.value.indexOf("*/")===-1&&(n=N(n,v,"accept",a=>k.value.some(s=>a.type.toUpperCase().startsWith(s)||a.name.toUpperCase().endsWith(s))),n.length===0))return p();if(o.maxFileSize!==void 0){const a=parseInt(o.maxFileSize,10);if(n=N(n,v,"max-file-size",s=>s.size<=a),n.length===0)return p()}if(o.multiple!==!0&&n.length!==0&&(n=[n[0]]),n.forEach(a=>{a.__key=a.webkitRelativePath+a.lastModified+a.name+a.size}),I===!0){const a=j.map(s=>s.__key);n=N(n,v,"duplicate",s=>a.includes(s.__key)===!1)}if(n.length===0)return p();if(o.maxTotalSize!==void 0){let a=I===!0?j.reduce((s,R)=>s+R.size,0):0;if(n=N(n,v,"max-total-size",s=>(a+=s.size,a<=_.value)),n.length===0)return p()}if(typeof o.filter=="function"){const a=o.filter(n);n=N(n,v,"filter",s=>a.includes(s))}if(o.maxFiles!==void 0){let a=I===!0?j.length:0;if(n=N(n,v,"max-files",()=>(a++,a<=F.value)),n.length===0)return p()}if(p(),n.length!==0)return n}function D(t){P(t),d.value!==!0&&(d.value=!0)}function u(t){E(t),(t.relatedTarget!==null||le.is.safari!==!0?t.relatedTarget!==x.value:document.elementsFromPoint(t.clientX,t.clientY).includes(x.value)===!1)===!0&&(d.value=!1)}function i(t){P(t);const h=t.dataTransfer.files;h.length!==0&&g(null,h),d.value=!1}function q(t){if(d.value===!0)return m("div",{ref:x,class:`q-${t}__dnd absolute-full`,onDragenter:P,onDragover:P,onDragleave:u,onDrop:i})}return Object.assign(y,{pickFiles:C,addFiles:z}),{pickFiles:C,addFiles:z,onDragover:D,onDragleave:u,processFiles:V,getDndNode:q,maxFilesNumber:F,maxTotalSizeNumber:_}}const qe=K({name:"QFile",inheritAttrs:!1,props:{...ue,...de,...ge,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ae,...he],setup(e,{slots:d,emit:b,attrs:g}){const{proxy:o}=w(),c=oe(),y=T(null),x=T(!1),k=fe(e),{pickFiles:F,onDragover:_,onDragleave:C,processFiles:z,getDndNode:V}=be({editable:c.editable,dnd:x,getFileInput:Q,addFilesToQueue:$}),D=re(e),u=r(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),i=r(()=>L(u.value)),q=r(()=>u.value.map(l=>l.name).join(", ")),t=r(()=>ce(u.value.reduce((l,f)=>l+f.size,0))),h=r(()=>({totalSize:t.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),j=r(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:k.value,...g,id:c.targetUid.value,disabled:c.editable.value!==!0})),I=r(()=>"q-file q-field--auto-height"+(x.value===!0?" q-file--dnd":"")),n=r(()=>e.multiple===!0&&e.append===!0);function v(l){const f=u.value.slice();f.splice(l,1),a(f)}function p(l){const f=u.value.indexOf(l);f!==-1&&v(f)}function a(l){b("update:modelValue",e.multiple===!0?l:l[0])}function s(l){l.keyCode===13&&ne(l)}function R(l){(l.keyCode===13||l.keyCode===32)&&F(l)}function Q(){return y.value}function $(l,f){const S=z(l,f,u.value,n.value),B=Q();B!=null&&(B.value=""),S!==void 0&&((e.multiple===!0?e.modelValue&&S.every(W=>u.value.includes(W)):e.modelValue===S[0])||a(n.value===!0?u.value.concat(S):S))}function A(){return[m("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function U(){if(d.file!==void 0)return u.value.length===0?A():u.value.map((f,S)=>d.file({index:S,file:f,ref:this}));if(d.selected!==void 0)return u.value.length===0?A():d.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?A():u.value.map((f,S)=>m(ve,{key:"file-"+S,removable:c.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{v(S)}},()=>m("span",{class:"ellipsis",textContent:f.name})));const l=e.displayValue!==void 0?e.displayValue:q.value;return l.length!==0?[m("div",{class:e.inputClass,style:e.inputStyle,textContent:l})]:A()}function M(){const l={ref:y,...j.value,...D.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:$};return e.multiple===!0&&(l.multiple=!0),m("input",l)}return Object.assign(c,{fieldClass:I,emitValue:a,hasValue:i,inputRef:y,innerValue:u,floatingLabel:r(()=>i.value===!0||L(e.displayValue)),computedCounter:r(()=>{if(e.counterLabel!==void 0)return e.counterLabel(h.value);const l=e.maxFiles;return`${u.value.length}${l!==void 0?" / "+l:""} (${t.value})`}),getControlChild:()=>V("file"),getControl:()=>{const l={ref:c.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return c.editable.value===!0&&Object.assign(l,{onDragover:_,onDragleave:C,onKeydown:s,onKeyup:R}),m("div",l,[M()].concat(U()))}}),Object.assign(o,{removeAtIndex:v,removeFile:p,getNativeElement:()=>y.value}),ie(o,"nativeEl",()=>y.value),se(c)}});export{qe as Q};
