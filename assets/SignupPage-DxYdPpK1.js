import{a as E,Q as q}from"./QInput-DUL8mcez.js";import{Q as B}from"./QFile-B9Up9AlC.js";import{Q as R,h as N}from"./QIcon-yr6XTtfM.js";import{c as Q,h as b,a as A,r as g,B as T,C as j,o as M,g as D,z as _,d as L,E as O,$,T as w,K as P,R as k,Q as f,L as z,a0 as H,S as K,M as J}from"./index-ClHkJBKQ.js";import{u as G,a as W,b as X}from"./use-checkbox-B6FHpS3j.js";import{a as Y,Q as F}from"./QBtn-Dql1VlLM.js";import"./use-dark-DtsLJodM.js";import"./private.use-form-kiQ69OuA.js";const Z=()=>b("div",{key:"svg",class:"q-checkbox__bg absolute"},[b("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[b("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),b("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),ee=Q({name:"QCheckbox",props:W,emits:G,setup(u){const v=Z();function i(p,n){const r=A(()=>(p.value===!0?u.checkedIcon:n.value===!0?u.indeterminateIcon:u.uncheckedIcon)||null);return()=>r.value!==null?[b("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[b(R,{class:"q-checkbox__icon",name:r.value})])]:[v]}return X("checkbox",i)}}),te=Q({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(u,{slots:v,emit:i}){const p=D(),n=g(null);let r=0;const d=[];function s(t){const a=typeof t=="boolean"?t:u.noErrorFocus!==!0,e=++r,o=(l,c)=>{i(`validation${l===!0?"Success":"Error"}`,c)},C=l=>{const c=l.validate();return typeof c.then=="function"?c.then(m=>({valid:m,comp:l}),m=>({valid:!1,comp:l,err:m})):Promise.resolve({valid:c,comp:l})};return(u.greedy===!0?Promise.all(d.map(C)).then(l=>l.filter(c=>c.valid!==!0)):d.reduce((l,c)=>l.then(()=>C(c).then(m=>{if(m.valid===!1)return Promise.reject(m)})),Promise.resolve()).catch(l=>[l])).then(l=>{if(l===void 0||l.length===0)return e===r&&o(!0),!0;if(e===r){const{comp:c,err:m}=l[0];if(m!==void 0&&console.error(m),o(!1,c),a===!0){const I=l.find(({comp:U})=>typeof U.focus=="function"&&Y(U.$)===!1);I!==void 0&&I.comp.focus()}}return!1})}function h(){r++,d.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function y(t){t!==void 0&&_(t);const a=r+1;s().then(e=>{a===r&&e===!0&&(u.onSubmit!==void 0?i("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function V(t){t!==void 0&&_(t),i("reset"),L(()=>{h(),u.autofocus===!0&&u.noResetFocus!==!0&&x()})}function x(){E(()=>{if(n.value===null)return;const t=n.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||n.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||n.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(n.value.querySelectorAll("[tabindex]"),a=>a.tabIndex!==-1);t?.focus({preventScroll:!0})})}O($,{bindComponent(t){d.push(t)},unbindComponent(t){const a=d.indexOf(t);a!==-1&&d.splice(a,1)}});let S=!1;return T(()=>{S=!0}),j(()=>{S===!0&&u.autofocus===!0&&x()}),M(()=>{u.autofocus===!0&&x()}),Object.assign(p.proxy,{validate:s,resetValidation:h,submit:y,reset:V,focus:x,getValidationComponents:()=>d}),()=>b("form",{class:"q-form",ref:n,onSubmit:y,onReset:V},N(v.default))}}),oe={class:"text-primary text-center q-pa-md flex flex-center"},ae={key:0,class:"q-mt-md"},le=["src"],se={key:1,class:"q-mt-md",style:{"max-width":"200px","max-height":"200px",border:"2px dashed #ccc",display:"flex","justify-content":"center","align-items":"center","font-size":"14px",color:"#aaa"}},ne={class:"text-h6",style:{opacity:".4"}},re="",be={__name:"SignupPage",setup(u){const v=g(""),i=g(""),p=g(""),n=g(""),r=g(!1),d=g(null),s=g(null),h=A(()=>i.value!==p.value),y=J(),V=a=>{if(a){const e=new FileReader;e.onload=o=>{s.value=o.target.result},e.readAsDataURL(s)}else s.value="";return{profilePicture:a,imageUrl:s,handleFileUpload:V}},x=()=>{s.value&&(localStorage.setItem("uploadedImage",s.value),console.log("Image saved to local storage."))},S=()=>{if(!h.value){console.log({email:v.value,password:i.value,passwordConfirm:p.value,username:n.value,termsAccepted:r.value,profilePicture:s.value});var a={email:v.value,password:i.value,username:n.value,profilePicture:s.value};fetch("https://vibemapbe.com/auth/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(e=>e.json()).then(e=>{re.status!=200?(alert(e),y.push("/profile")):(console.log("Signup successful:",e),y.push("/"),x())}).catch(e=>{console.error("Signup error:",e),alert("Signup failed. Please try again. Error: "+e)})}},t=()=>{const a=d.value?.[0];if(a){const e=new FileReader;e.onload=o=>{s.value=o.target.result},e.readAsDataURL(a)}};return(a,e)=>(P(),w("div",oe,[k("div",null,[e[7]||(e[7]=k("div",{class:"text-h5"},"Signup Page",-1)),f(te,{class:"q-gutter-md signup-form",onSubmit:H(S,["prevent"])},{default:z(()=>[f(q,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),label:"Username",filled:"",required:""},null,8,["modelValue"]),f(B,{modelValue:d.value,"onUpdate:modelValue":[e[1]||(e[1]=o=>d.value=o),V],label:"Upload Profile Picture",filled:"",accept:"image/*","max-files":1,onAdded:t},null,8,["modelValue"]),s.value?(P(),w("div",ae,[k("img",{src:s.value,alt:"Profile Preview",class:"q-mb-md",style:{"max-width":"200px","max-height":"200px","object-fit":"cover"}},null,8,le)])):(P(),w("div",se," No Image Uploaded ")),f(q,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=o=>v.value=o),label:"Email Address",type:"email",filled:"",required:""},null,8,["modelValue"]),f(q,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=o=>i.value=o),label:"Password",type:"password",filled:"",required:""},null,8,["modelValue"]),f(q,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=o=>p.value=o),label:"Confirm Password",type:"password",filled:"",required:"",error:h.value,"error-message":"Passwords do not match"},null,8,["modelValue","error"]),f(ee,{modelValue:r.value,"onUpdate:modelValue":e[5]||(e[5]=o=>r.value=o),label:"I agree to the Terms of Use",required:""},null,8,["modelValue"]),f(F,{label:"Sign Up",color:"primary",type:"submit",unelevated:"",class:"q-mt-md"})]),_:1}),k("div",ne,[e[6]||(e[6]=K(" Already have an account? ")),f(F,{flat:"",to:"/profile",label:"Login"})])])]))}};export{be as default};
