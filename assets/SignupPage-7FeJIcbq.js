import{a as j,Q as E}from"./QInput-CISX9uWL.js";import{Q as $}from"./QFile-DeOpDMyz.js";import{Q as K,h as J}from"./QIcon-fJVbjNqT.js";import{c as D,h as w,a as L,r as b,B as G,C as H,o as X,g as Y,z as T,d as Z,E as W,$ as ee,T as Q,K as B,R as U,Q as v,L as te,a0 as oe,S as ae,M as se}from"./index-BJeGirkj.js";import{u as le,a as re,b as ne}from"./use-checkbox-ttezPffR.js";import{a as ie,Q as M}from"./QBtn-BKTEDeIv.js";import"./use-dark-BrRAgpsI.js";import"./private.use-form-DhTdLF3v.js";const ue=()=>w("div",{key:"svg",class:"q-checkbox__bg absolute"},[w("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[w("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),w("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),ce=D({name:"QCheckbox",props:re,emits:le,setup(u){const g=ue();function c(h,r){const n=L(()=>(h.value===!0?u.checkedIcon:r.value===!0?u.indeterminateIcon:u.uncheckedIcon)||null);return()=>n.value!==null?[w("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[w(K,{class:"q-checkbox__icon",name:n.value})])]:[g]}return ne("checkbox",c)}}),de=D({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(u,{slots:g,emit:c}){const h=Y(),r=b(null);let n=0;const d=[];function m(t){const s=typeof t=="boolean"?t:u.noErrorFocus!==!0,e=++n,o=(a,l)=>{c(`validation${a===!0?"Success":"Error"}`,l)},P=a=>{const l=a.validate();return typeof l.then=="function"?l.then(i=>({valid:i,comp:a}),i=>({valid:!1,comp:a,err:i})):Promise.resolve({valid:l,comp:a})};return(u.greedy===!0?Promise.all(d.map(P)).then(a=>a.filter(l=>l.valid!==!0)):d.reduce((a,l)=>a.then(()=>P(l).then(i=>{if(i.valid===!1)return Promise.reject(i)})),Promise.resolve()).catch(a=>[a])).then(a=>{if(a===void 0||a.length===0)return e===n&&o(!0),!0;if(e===n){const{comp:l,err:i}=a[0];if(i!==void 0&&console.error(i),o(!1,l),s===!0){const f=a.find(({comp:p})=>typeof p.focus=="function"&&ie(p.$)===!1);f!==void 0&&f.comp.focus()}}return!1})}function k(){n++,d.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function q(t){t!==void 0&&T(t);const s=n+1;m().then(e=>{s===n&&e===!0&&(u.onSubmit!==void 0?c("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function I(t){t!==void 0&&T(t),c("reset"),Z(()=>{k(),u.autofocus===!0&&u.noResetFocus!==!0&&V()})}function V(){j(()=>{if(r.value===null)return;const t=r.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(r.value.querySelectorAll("[tabindex]"),s=>s.tabIndex!==-1);t?.focus({preventScroll:!0})})}W(ee,{bindComponent(t){d.push(t)},unbindComponent(t){const s=d.indexOf(t);s!==-1&&d.splice(s,1)}});let C=!1;return G(()=>{C=!0}),H(()=>{C===!0&&u.autofocus===!0&&V()}),X(()=>{u.autofocus===!0&&V()}),Object.assign(h.proxy,{validate:m,resetValidation:k,submit:q,reset:I,focus:V,getValidationComponents:()=>d}),()=>w("form",{class:"q-form",ref:r,onSubmit:q,onReset:I},J(g.default))}}),me={class:"text-primary text-center q-pa-md flex flex-center"},fe={key:0,class:"q-mt-md"},pe=["src"],ve={key:1,class:"q-mt-md",style:{"max-width":"200px","max-height":"200px",border:"2px dashed #ccc",display:"flex","justify-content":"center","align-items":"center","font-size":"14px",color:"#aaa"}},ge={class:"text-h6",style:{opacity:".4"}},he="",qe={__name:"SignupPage",setup(u){const g=b(""),c=b(""),h=b(""),r=b(""),n=b(!1),d=b(null),m=b(null),k=L(()=>c.value!==h.value),q=se(),I=(s,e=180,o=180,P=40)=>new Promise((A,a)=>{const l=new FileReader;l.onload=i=>{const f=new Image;f.src=i.target.result,f.onload=()=>{const p=document.createElement("canvas"),O=p.getContext("2d");let x=f.width,y=f.height;x>y?x>e&&(y*=e/x,x=e):y>o&&(x*=o/y,y=o),p.width=x,p.height=y,O.drawImage(f,0,0,x,y);const R=S=>new Promise((z,F)=>{p.toBlob(_=>{if(!_){F(new Error("Failed to compress image."));return}if(_.size/1024<=P)z(_);else{const N=S-.1;N>=.1?R(N).then(z).catch(F):F(new Error("Unable to compress image below the specified size."))}},"image/jpeg",S)});R(.9).then(S=>A(S)).catch(S=>a(S))},f.onerror=p=>{a(p)}},l.onerror=i=>{a(i)},l.readAsDataURL(s)}),V=async s=>{if(s)try{const e=await I(s),o=new FileReader;o.onload=P=>{m.value=P.target.result},o.readAsDataURL(e)}catch(e){console.error("Error resizing image:",e),alert("Failed to resize image. Please try again.")}else m.value=""},C=()=>{m.value&&(localStorage.setItem("uploadedImage",m.value),console.log("Image saved to local storage."))},t=()=>{if(!k.value){console.log({email:g.value,password:c.value,passwordConfirm:h.value,username:r.value,termsAccepted:n.value,profilePicture:m.value});var s={email:g.value,password:c.value,username:r.value};fetch("https://vibemapbe.com/auth/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(e=>e.json()).then(e=>{he.status!=200?(alert(e),q.push("/profile")):(console.log("Signup successful:",e),q.push("/"),C())}).catch(e=>{console.error("Signup error:",e),alert("Signup failed. Please try again. Error: "+e)})}};return(s,e)=>(B(),Q("div",me,[U("div",null,[e[7]||(e[7]=U("div",{class:"text-h5"},"Signup Page",-1)),v(de,{class:"q-gutter-md signup-form",onSubmit:oe(t,["prevent"])},{default:te(()=>[v(E,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),label:"Username",filled:"",required:""},null,8,["modelValue"]),v($,{modelValue:d.value,"onUpdate:modelValue":[e[1]||(e[1]=o=>d.value=o),V],label:"Upload Profile Picture",filled:"",accept:"image/*","max-files":1},null,8,["modelValue"]),m.value?(B(),Q("div",fe,[U("img",{src:m.value,alt:"Profile Preview",class:"q-mb-md",style:{"max-width":"200px","max-height":"200px","object-fit":"cover"}},null,8,pe)])):(B(),Q("div",ve," No Image Uploaded ")),v(E,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=o=>g.value=o),label:"Email Address",type:"email",filled:"",required:""},null,8,["modelValue"]),v(E,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=o=>c.value=o),label:"Password",type:"password",filled:"",required:""},null,8,["modelValue"]),v(E,{modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=o=>h.value=o),label:"Confirm Password",type:"password",filled:"",required:"",error:k.value,"error-message":"Passwords do not match"},null,8,["modelValue","error"]),v(ce,{modelValue:n.value,"onUpdate:modelValue":e[5]||(e[5]=o=>n.value=o),label:"I agree to the Terms of Use",required:""},null,8,["modelValue"]),v(M,{label:"Sign Up",color:"primary",type:"submit",unelevated:"",class:"q-mt-md"})]),_:1}),U("div",ge,[e[6]||(e[6]=ae(" Already have an account? ")),v(M,{flat:"",to:"/profile",label:"Login"})])])]))}};export{qe as default};
